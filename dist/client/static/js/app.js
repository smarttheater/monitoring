webpackJsonp([1],{"/8M+":function(t,e){},0:function(t,e){},"0B7i":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7QTg"),a=n("mtWM"),i=n.n(a),o=n("PJh5"),s=n("4E7i"),c=n("7+uW"),u=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,s)}c((r=r.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};n("ORgI"),o.locale("ja");var d=c.a.extend({components:{swiper:r.swiper,swiperSlide:r.swiperSlide},data:function(){return{APPCONFIG:this.$store.state.APPCONFIG,flg_loaded:!1,lastupdateStr:"未取得",chekpointDefinition:{},scheduleArray:[],currentScheduleIndex:null,timeoutInstance_IntervalFetch:null,swiperOption:{autoplay:!1,centeredSlides:!0,grabCursor:!0,mousewheelControl:!0,paginationClickable:!1,scrollbar:".swiper-scrollbar",slidesPerView:3,spaceBetween:30}}},created:function(){var t=this;this.$store.commit("SET_LOADINGMSG","認証場所の一覧を取得中..."),this.refreshCheckpointsData().then(function(){t.$store.commit("SET_LOADINGMSG","来塔状況を取得中..."),t.fetchData().then(function(){t.flg_loaded=!0,t.setFetchDataInterval(),t.$store.commit("CLEAR_LOADINGMSG")})})},beforeDestroy:function(){null!==this.timeoutInstance_IntervalFetch&&clearTimeout(this.timeoutInstance_IntervalFetch)},methods:{fetchScheduleStatus:s.a.fetchScheduleStatus,focusCurrentSchedule:function(){var t=this;if(this.scheduleArray.length<2)return!1;var e=this.$store.state.moment.format("YYYY-MM-DD"),n=this.scheduleArray.findIndex(function(n){return t.$store.state.moment.isBetween(e+" "+n.start_time+":00",e+" "+n.end_time+":59")});return n<0&&this.$store.state.moment.isAfter(e+" "+this.scheduleArray[this.scheduleArray.length-1].end_time+":59")&&(n=Number.MAX_VALUE),n>=0&&n<=this.scheduleArray.length&&this.$refs.scheduleSwiper.swiper.slideTo(n),this.currentScheduleIndex=n,!0},manipulateScheduleData:function(t){var e=this,n={};return void 0!==t[0].checkinCountsByWhere&&t[0].checkinCountsByWhere[0].checkinCountsByTicketType.forEach(function(t){n[t.ticketType]=t.ticketCategory}),t.map(function(t){var r={notConcerned:0,concerned:0};return void 0!==t.reservationCountsByTicketType&&t.reservationCountsByTicketType.forEach(function(t){"number"!=typeof r[n[t.ticketType]]&&(r[n[t.ticketType]]=0),r[n[t.ticketType]]+=t.count,-1===e.APPCONFIG.VSTRSTAT_CONCERNED_CATEGORYCODE_ARRAY.indexOf(n[t.ticketType])?r.notConcerned+=t.count:r.concerned+=t.count}),{performanceId:t.id,start_time:o(t.startDate).format("HH:mm"),end_time:o(t.endDate).format("HH:mm"),normalReservedNum:r.notConcerned,concernedReservationArray:e.APPCONFIG.VSTRSTAT_CONCERNED_CATEGORYCODE_ARRAY.filter(function(t){return"number"==typeof r[t]}).map(function(t){return{name:t,reservedNum:r[t]}}),checkpointStatusArray:void 0===t.checkinCountsByWhere?[]:t.checkinCountsByWhere.filter(function(t){return-1!==e.APPCONFIG.VSTRSTAT_CHECKPOINT_TARGETWHERE_ARRAY.indexOf(t.where)}).map(function(t){var n={notConcerned:0,concerned:0};return t.checkinCountsByTicketType.forEach(function(t){"number"!=typeof n[t.ticketCategory]&&(n[t.ticketCategory]=0),n[t.ticketCategory]+=t.count,-1===e.APPCONFIG.VSTRSTAT_CONCERNED_CATEGORYCODE_ARRAY.indexOf(t.ticketCategory)?n.notConcerned+=t.count:n.concerned+=t.count}),{id:t.where,name:e.chekpointDefinition[t.where],normalUnarrivedNum:r.notConcerned-n.notConcerned,concernedUnarrivedArray:e.APPCONFIG.VSTRSTAT_CONCERNED_CATEGORYCODE_ARRAY.filter(function(t){return"number"==typeof r[t]}).map(function(t){return{name:t,unarrivedNum:r[t]-n[t]}})}})}})},legacyRefreshCheckpointsData:function(){var t=this;return new Promise(function(e){i.a.get(t.APPCONFIG.API_CHECKPOINTDIFINITION_ENDPOINT,{timeout:t.APPCONFIG.API_TIMEOUT}).then(function(e){return Array.isArray(e.data)&&e.data.length?(e.data.forEach(function(e){t.chekpointDefinition[e.identifier]=e.name}),t.$store.commit("CLEAR_ERRORMSG"),!0):t.$store.commit("SET_ERRORMSG","("+t.$store.state.moment.format("HH:mm:ss")+") [チェックポイントの定義が読み込めませんでした][/places/checkinGate]")}).catch(function(e){t.$store.commit("SET_ERRORMSG","("+t.$store.state.moment.format("HH:mm:ss")+") [通信エラー][チェックポイント一覧取得] ["+e.message+"]")}).then(function(){e()})})},refreshCheckpointsData:function(){var t=this;return new Promise(function(e){s.a.fetchMovieTheater(t.$store).then(function(e){return 0===e.length||void 0===e[0].hasEntranceGate?t.$store.commit("SET_ERRORMSG","("+t.$store.state.moment.format("HH:mm:ss")+") [チェックポイントの定義が読み込めませんでした][/places/checkinGate]"):(e[0].hasEntranceGate.forEach(function(e){var n;void 0!==e.identifier&&"string"==typeof e.identifier&&(t.chekpointDefinition[e.identifier]="string"==typeof e.name?e.name:String(null===(n=e.name)||void 0===n?void 0:n.ja))}),t.$store.commit("CLEAR_ERRORMSG"),!0)}).catch(function(e){t.$store.commit("SET_ERRORMSG","("+t.$store.state.moment.format("HH:mm:ss")+") [通信エラー][チェックポイント一覧取得] ["+e.message+"]")}).then(function(){e()})})},fetchData:function(){var t=this;return new Promise(function(e){return u(t,void 0,void 0,function(){var t,n;return l(this,function(r){switch(r.label){case 0:return(t={startFrom:new Date,startThrough:new Date}).startFrom.setHours(0,0,0,0),t.startThrough.setHours(23,59,59,999),[4,this.fetchScheduleStatus(this.$store,t)];case 1:return"object"==typeof(n=r.sent())[0]&&(this.scheduleArray=this.manipulateScheduleData(n),this.lastupdateStr=this.$store.state.moment.format("HH:mm:ss")+"時点データ表示中"),this.focusCurrentSchedule(),e(),[2]}})})})},setFetchDataInterval:function(){var t=this;this.timeoutInstance_IntervalFetch=setTimeout(function(){t.fetchData().then(function(){t.setFetchDataInterval()})},s.a.getNextTickUnixtime())},manualUpdate:function(){var t=this;return!this.$store.state.loadingMsg&&(this.$store.commit("SET_LOADINGMSG","来塔状況を取得中..."),null!==this.timeoutInstance_IntervalFetch&&clearTimeout(this.timeoutInstance_IntervalFetch),this.fetchData().catch(function(t){console.log(t)}).then(function(){t.setFetchDataInterval(),t.$store.commit("CLEAR_LOADINGMSG")}))}}}),f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[n("myHeader",[n("div",{staticClass:"statheadermenu",attrs:{slot:"headerMenu"},slot:"headerMenu"},[n("div",{staticClass:"lastupdate"},[n("span",[t._v(t._s(t.lastupdateStr))]),n("br"),t._v("(1分毎に自動更新)\n      ")]),t._v(" "),n("div",{staticClass:"btn-update",on:{click:t.manualUpdate}},[t._v("更新")])])]),t._v(" "),t.$store.state.errorMsgStr?n("errorOneline",{attrs:{errorMsgStr:"データ取得エラーが発生しています "+t.$store.state.errorMsgStr}}):t._e(),t._v(" "),n("div",{staticClass:"clockwrapper",on:{click:t.focusCurrentSchedule}},[n("p",[n("span",{staticClass:"iconBefore icon-clock"},[t._v(t._s(t.$store.state.moment.format("YYYY/MM/DD (dd)")))]),n("clock",{staticClass:"hhmm"})],1)]),t._v(" "),n("main",[n("swiper",{ref:"scheduleSwiper",attrs:{options:t.swiperOption}},[t._l(t.scheduleArray,function(e,r){return n("swiper-slide",{key:e.performanceId,class:["schedule",{"schedule-active":t.currentScheduleIndex===r,"schedule-past":t.currentScheduleIndex>r}]},[n("div",{staticClass:"scheduleheader"},[n("div",{staticClass:"status"}),t._v(" "),n("div",{staticClass:"time"},[t._v("\n            "+t._s(e.start_time+"～"+e.end_time)+"\n          ")])]),t._v(" "),n("table",[n("tbody",[n("tr",[n("th",[t._v("来塔予定")]),t._v(" "),n("td",[n("p",[n("span",{staticClass:"personNum iconBefore icon-standing"},[t._v(t._s(e.normalReservedNum))])]),t._v(" "),t._l(e.concernedReservationArray,function(r){return n("p",{key:""+e.id+r.name},[n("span",{class:["personNum iconBefore","icon-"+r.name]},[t._v(t._s(r.reservedNum))])])})],2)]),t._v(" "),t._l(e.checkpointStatusArray,function(r){return n("tr",{key:e.performanceId+"_"+r.id,class:["checkpoint","checkpoint-"+r.id]},[n("th",[t._v(t._s(r.name)),n("br"),t._v("未通過")]),t._v(" "),n("td",[n("p",[n("span",{staticClass:"personNum iconBefore icon-standing"},[t._v(t._s(r.normalUnarrivedNum))])]),t._v(" "),t._l(r.concernedUnarrivedArray,function(e){return n("p",{key:""+r.id+e.name},[n("span",{class:["personNum iconBefore","icon-"+e.name]},[t._v(t._s(e.unarrivedNum))])])})],2)])})],2)])])}),t._v(" "),n("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"})],2)],1)],1)},staticRenderFns:[]};var h=n("VU/8")(d,f,!1,function(t){n("/8M+")},"data-v-532957ea",null);e.default=h.exports},"2GI+":function(t,e){},"3iqB":function(t,e){},"4E7i":function(t,e,n){"use strict";var r={};n.d(r,"getCredentials",function(){return f}),n.d(r,"createOption",function(){return h});var a={};n.d(a,"EvServiceStatus",function(){return m}),n.d(a,"OnlineSalesStatus",function(){return v});var i={};n.d(i,"sleep",function(){return _});var o={};n.d(o,"getNextTickUnixtime",function(){return b}),n.d(o,"getStatusClassNameByPerformance",function(){return A}),n.d(o,"legacyFetchScheduleStatus",function(){return T}),n.d(o,"fetchScheduleStatus",function(){return E}),n.d(o,"performance2result",function(){return w}),n.d(o,"fetchMovieTheater",function(){return O});var s=n("N4dp"),c=n("mtWM"),u=n.n(c),l=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,s)}c((r=r.apply(t,e||[])).next())})},d=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function f(t){return l(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,u.a.post("/api/authorize/getCredentials",{},{timeout:Number(t.API_TIMEOUT)})];case 1:return[2,e.sent().data]}})})}function h(t){return l(this,void 0,void 0,function(){var e,n,r;return d(this,function(a){switch(a.label){case 0:return[4,f(t)];case 1:return e=a.sent(),n={domain:"",clientId:e.clientId,redirectUri:"",logoutUri:"",responseType:"",scope:"",state:"",nonce:null,tokenIssuer:""},(r=s.createAuthInstance(n)).setCredentials(e),[2,{endpoint:e.endpoint,auth:r,project:{id:t.PROJECT_ID}}]}})})}var m,v,p=n("PJh5");function _(t){return new Promise(function(e){return setTimeout(e,t)})}!function(t){t.Normal="Normal",t.Slowdown="Slowdown",t.Suspended="Suspended"}(m||(m={})),function(t){t.Normal="Normal",t.Suspended="Suspended"}(v||(v={}));var y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)},S=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,s)}c((r=r.apply(t,e||[])).next())})},g=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},C=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),a=0;for(e=0;e<n;e++)for(var i=arguments[e],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r};function b(){var t=p();return p(t.format("YYYYMMDD HHmm"),"YYYYMMDD HHmm").add(1,"minutes").diff(t,"milliseconds")}function A(t,e,n){var r="",a=t.format("YYYY-MM-DD");if(!e.is_avg&&(t.isBetween(a+" "+e.start_time+":00",a+" "+e.end_time+":59")&&(r+="item-current"),t.isAfter(a+" "+e.end_time+":59")))return r+" item-soldout";if("Normal"!==e.online_sales_status)return"item-supenpeded";var i=parseInt(e.seat_status,10)||0;return i<=n&&i>0?r+" item-last":0===i?r+" item-soldout":r+" item-capable"}function T(t,e){var n=t.state.APPCONFIG;return new Promise(function(r){u.a.get(n.API_STATUS_ENDPOINT,{params:e,timeout:n.API_TIMEOUT}).then(function(e){t.commit("UPDATE_MOMENTOBJ");var n="";return Array.isArray(e.data)?e.data[0]||(n="("+t.state.moment.format("HH:mm:ss")+")[スケジュールデータが見つかりませんでした]"):n="("+t.state.moment.format("HH:mm:ss")+")[取得データが異常です]",n?t.commit("SET_ERRORMSG",n):t.commit("CLEAR_ERRORMSG"),r(e.data.sort(function(t,e){return t.startDate<e.startDate?-1:t.startDate>e.startDate?1:0}))}).catch(function(e){return console.log(e),t.commit("UPDATE_MOMENTOBJ"),t.commit("SET_ERRORMSG","("+t.state.moment.format("HH:mm:ss")+")[通信エラー][ステータス取得] "+e.message+" "),r([])})})}function E(t,e){return S(this,void 0,void 0,function(){var n,r,a,i,o,c,u,l,d,f,m,v;return g(this,function(p){switch(p.label){case 0:return p.trys.push([0,7,,8]),void 0===(n=t.state.APPCONFIG).API_STATUS_ENDPOINT&&new Error("API_STATUS_ENDPOINT undefined"),i=(a=s.service.Event).bind,[4,h(n)];case 1:r=new(i.apply(a,[void 0,p.sent()])),o=100,c=1,u=!0,l=[],p.label=2;case 2:return u?[4,r.search(y({page:c,limit:o,typeOf:s.factory.chevre.eventType.ScreeningEvent,startFrom:e.startFrom,startThrough:e.startThrough,sort:{startDate:1}},{$projection:{checkInCount:0,maximumAttendeeCapacity:0,remainingAttendeeCapacity:0}}))]:[3,6];case 3:return d=p.sent(),l=C(l,d.data),c++,(u=d.data.length===o)?[4,_(1e3)]:[3,5];case 4:p.sent(),p.label=5;case 5:return[3,2];case 6:return t.commit("UPDATE_MOMENTOBJ"),f="",Array.isArray(l)?0===l.length?(f="("+t.state.moment.format("HH:mm:ss")+")[スケジュールデータが見つかりませんでした]",t.commit("SET_ERRORMSG",f),[2,[]]):(t.commit("CLEAR_ERRORMSG"),m=l.sort(function(t,e){return t.startDate<e.startDate?-1:t.startDate>e.startDate?1:0}),[2,m.map(function(t){return w(t)})]):(f="("+t.state.moment.format("HH:mm:ss")+") [取得データ異常]",t.commit("SET_ERRORMSG",f),[2,[]]);case 7:return v=p.sent(),console.log(v),t.commit("UPDATE_MOMENTOBJ"),t.commit("SET_ERRORMSG","("+t.state.moment.format("HH:mm:ss")+") [通信エラー][ステータス取得] "+v.message),[2,[]];case 8:return[2]}})})}function w(t){var e,n,r,i,o,c,u,l,d,f,h,m,v,p,_,S,g=null===(n=null===(e=t.additionalProperty)||void 0===e?void 0:e.find(function(t){return"tourNumber"===t.name}))||void 0===n?void 0:n.value,C=a.EvServiceStatus.Normal,b=a.OnlineSalesStatus.Normal;switch(t.eventStatus){case s.factory.chevre.eventStatusType.EventCancelled:C=a.EvServiceStatus.Suspended,b=a.OnlineSalesStatus.Suspended;break;case s.factory.chevre.eventStatusType.EventPostponed:C=a.EvServiceStatus.Slowdown,b=a.OnlineSalesStatus.Suspended;break;case s.factory.chevre.eventStatusType.EventScheduled:}var A,T,E,w,O,D=null===(r=t.aggregateOffer)||void 0===r?void 0:r.offers,M=Array.isArray(D)?D.map(function(t){var e;return{ticketType:t.id,ticketCategory:null===(e=t.category)||void 0===e?void 0:e.codeValue,count:0}}):[],I=[{where:"DAITEN_AUTH",checkinCountsByTicketType:M},{where:"TOPDECK_AUTH",checkinCountsByTicketType:M}],k=0;A=null===(c=null===(o=null===(i=t.aggregateOffer)||void 0===i?void 0:i.offers)||void 0===o?void 0:o.find(function(t){return"001"===t.identifier}))||void 0===c?void 0:c.maximumAttendeeCapacity,T=null===(d=null===(l=null===(u=t.aggregateOffer)||void 0===u?void 0:u.offers)||void 0===l?void 0:l.find(function(t){return"001"===t.identifier}))||void 0===d?void 0:d.remainingAttendeeCapacity,E=null===(m=null===(h=null===(f=t.aggregateOffer)||void 0===f?void 0:f.offers)||void 0===h?void 0:h.find(function(t){return"004"===t.identifier}))||void 0===m?void 0:m.remainingAttendeeCapacity,w=null===(v=t.aggregateReservation)||void 0===v?void 0:v.reservationCount,O=null===(_=null===(p=t.aggregateOffer)||void 0===p?void 0:p.offers)||void 0===_?void 0:_.map(function(t){var e;return{ticketType:t.id,count:null===(e=t.aggregateReservation)||void 0===e?void 0:e.reservationCount}});var R=null===(S=t.aggregateEntranceGate)||void 0===S?void 0:S.places;return Array.isArray(R)&&(I=R.map(function(t){var e,n;return{where:t.identifier,checkinCountsByTicketType:null===(n=null===(e=t.aggregateOffer)||void 0===e?void 0:e.offers)||void 0===n?void 0:n.map(function(t){var e,n;return{ticketType:t.id,ticketCategory:null===(e=t.category)||void 0===e?void 0:e.codeValue,count:null===(n=t.aggregateReservation)||void 0===n?void 0:n.useActionCount}})}}),k=R.reduce(function(t,e){var n,r=t,a=null===(n=e.aggregateOffer)||void 0===n?void 0:n.offers;return Array.isArray(a)&&(r+=a.reduce(function(t,e){var n;return t+Number(null===(n=e.aggregateReservation)||void 0===n?void 0:n.useActionCount)},0)),r},0)),y(y(y(y(y(y(y(y({},t),{evServiceStatus:C,onlineSalesStatus:b,tourNumber:g}),"number"==typeof A?{maximumAttendeeCapacity:A}:void 0),"number"==typeof T?{remainingAttendeeCapacity:T}:void 0),"number"==typeof E?{remainingAttendeeCapacityForWheelchair:E}:void 0),"number"==typeof w?{reservationCount:w}:void 0),Array.isArray(O)?{reservationCountsByTicketType:O}:void 0),{checkinCountsByWhere:I,checkinCount:k})}function O(t){return S(this,void 0,void 0,function(){var e,n,r,a,i,o,c,u,l;return g(this,function(d){switch(d.label){case 0:return void 0===(e=t.state.APPCONFIG).API_STATUS_ENDPOINT&&new Error("API_STATUS_ENDPOINT undefined"),a=(r=s.service.Place).bind,[4,h(e)];case 1:n=new(a.apply(r,[void 0,d.sent()])),i=100,o=1,c=!0,u=[],d.label=2;case 2:return c?[4,n.searchMovieTheaters({page:o,limit:i})]:[3,6];case 3:return l=d.sent(),u=C(u,l.data),o++,(c=l.data.length===i)?[4,_(1e3)]:[3,5];case 4:d.sent(),d.label=5;case 5:return[3,2];case 6:return[2,u]}})})}n.d(e,!1,function(){return r}),n.d(e,"a",function(){return o}),n.d(e,!1,function(){return i})},"4S28":function(t,e){},"5tzQ":function(t,e){},"8ftZ":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW").a.extend({}),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"clock"},[e("span",[this._v(this._s(this.$store.state.moment.format("HH"))),e("span",{staticClass:"colon"},[this._v(":")]),this._v(this._s(this.$store.state.moment.format("mm")))])])},staticRenderFns:[]};var i=n("VU/8")(r,a,!1,function(t){n("4S28")},null,null);e.default=i.exports},CELx:function(t,e){},"Cx+x":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW").a.extend({components:{Loading:n("hILp").default}}),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{class:{noscroll:this.$route.meta.noscroll},attrs:{id:"app"}},[this.$store.state.loadingMsg?e("loading"):this._e(),this._v(" "),e("transition",{attrs:{name:"fadeup"}},[e("router-view")],1)],1)},staticRenderFns:[]};var i=n("VU/8")(r,a,!1,function(t){n("CELx")},null,null);e.default=i.exports},H4kj:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("MU8w"),n("JUaF");var r=n("7+uW"),a=n("NYxO"),i=n("mtWM"),o=n.n(i),s=n("PJh5"),c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,s)}c((r=r.apply(t,e||[])).next())})},u=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};r.a.use(a.a);var l=new a.a.Store({strict:!1,modules:{},state:{moment:s(),APPCONFIG:{},errorMsgStr:"",loadingMsg:"",scheduleStatus:[]},mutations:{SET_APPCONFIG:function(t,e){t.APPCONFIG=e},SET_ERRORMSG:function(t,e){t.errorMsgStr=e},CLEAR_ERRORMSG:function(t){t.errorMsgStr=""},SET_LOADINGMSG:function(t,e){t.loadingMsg=e},CLEAR_LOADINGMSG:function(t){t.loadingMsg=""},SET_SCHEDULESTATUS:function(t,e){t.scheduleStatus=e},UPDATE_MOMENTOBJ:function(t){t.moment=s()}},actions:{FETCH_APPCONFIG:function(t){var e=this,n=t.commit;return new Promise(function(t,r){return c(e,void 0,void 0,function(){var e;return u(this,function(a){return e="/api/config",o.a.get(e).then(function(e){return"object"!=typeof e.data||Object.keys(e.data).some(function(t){return!e.data[t]||!e.data[t][0]})?r():(n("SET_APPCONFIG",e.data),t(e.data))}).catch(function(t){return console.error(t),r()}),[2]})})})},QUIT:function(){var t=this;return new Promise(function(e){return c(t,void 0,void 0,function(){return u(this,function(t){return window.location.href=window.location.href.split("#")[0],e(),[2]})})})}}}),d=n("/ocq");r.a.use(d.a);var f=new d.a({routes:[{name:"home",path:"/",component:n("yPrU").default,meta:{title:"東京タワー業務用画面"}},{name:"rsrvstat",path:"/rsrvstat",component:n("YJyu").default,meta:{title:"東京タワー予約状況"}},{name:"vstrstat",path:"/vstrstat",component:n("0B7i").default,meta:{title:"東京タワー来塔状況"}}]});f.beforeEach(function(t,e,n){return window.document.title=t.meta.title,n()}),f.afterEach(function(){l.commit("CLEAR_LOADINGMSG")});var h=f;r.a.component("Clock",n("8ftZ").default),r.a.component("myHeader",n("aa0c").default),r.a.component("ErrorOneline",n("wQMa").default),l.dispatch("FETCH_APPCONFIG").then(function(t){console.log("APPCONFIG",t),new r.a({el:"#VueApp",router:h,store:l,render:function(t){return t(n("Cx+x").default)},created:function(){}})}).catch(function(){return alert("CONFIG LOAD ERROR")})},XZz1:function(t,e){},YJyu:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("PJh5"),a=(n("JV9Q"),n("4E7i")),i=n("7+uW"),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=i.a.extend({components:{},data:function(){return{lastupdateStr:"未取得",moment:r,dayMomentArray:[],selectedDay:this.$route.query.day||r().format("YYYYMMDD"),hourArray:[],performancesByHour:{},timeoutInstance_IntervalFetch:null,bool_hidepasthours:!0}},computed:{dayparam:function(){return this.$route.query.day},isToday:function(){return this.$data.selectedDay===this.$store.state.moment.format("YYYYMMDD")}},methods:{fetchScheduleStatus:a.a.fetchScheduleStatus,getStatusClassNameByPerformance:a.a.getStatusClassNameByPerformance,createDaySelect:function(){this.dayMomentArray=r.twix(r(),r().add(7,"days")).toArray("days")},changeDay:function(t){null!==t.target&&(this.selectedDay=t.target.value,this.manualUpdate())},manipulateScheduleData:function(t){return t.map(function(t){var e="オンライン販売中";return"Suspended"===t.onlineSalesStatus&&(e="Slowdown"===t.evServiceStatus?"オンライン販売休止":"オンライン販売中止"),{id:t.id,hour:r(t.startDate).format("HH"),start_time:r(t.startDate).format("HH:mm"),end_time:r(t.endDate).format("HH:mm"),seat_status:t.remainingAttendeeCapacity,wheelchair_available:t.remainingAttendeeCapacityForWheelchair,tourNumber:t.tourNumber,online_sales_status:t.onlineSalesStatus,ev_status:t.evServiceStatus,tour_number:t.tourNumber,capacity:t.maximumAttendeeCapacity,sales_textstatus:e}})},updateStatus:function(){return o(this,void 0,void 0,function(){var t,e,n;return s(this,function(a){switch(a.label){case 0:return[4,this.fetchScheduleStatus(this.$store,{startFrom:r(this.selectedDay+" 000000","YYYYMMDD HHmmss").toDate(),startThrough:r(this.selectedDay+" 235959","YYYYMMDD HHmmss").toDate()})];case 1:return"object"!=typeof(t=a.sent())[0]?[2,!1]:(e=[],n={},this.manipulateScheduleData(t).forEach(function(t){try{var r=t.hour;n[r]||(e.push(r),n[r]=[]),n[r].push(t)}catch(t){return console.log(t),!0}return!0}),this.hourArray=e,this.performancesByHour=n,this.lastupdateStr=this.$store.state.moment.format("HH:mm:ss")+"時点データ表示中",[2,!0])}})})},setFetchDataInterval:function(){var t=this;this.timeoutInstance_IntervalFetch=setTimeout(function(){t.updateStatus().then(function(){t.setFetchDataInterval()})},a.a.getNextTickUnixtime())},manualUpdate:function(){var t=this;return!this.$store.state.loadingMsg&&(this.$store.commit("SET_LOADINGMSG","予約状況を取得中..."),null!==this.timeoutInstance_IntervalFetch&&clearTimeout(this.timeoutInstance_IntervalFetch),this.updateStatus().catch(function(t){console.log(t)}).then(function(){t.$store.commit("CLEAR_LOADINGMSG"),t.setFetchDataInterval()}))}},watch:{dayparam:function(){this.manualUpdate()}},created:function(){this.createDaySelect(),this.manualUpdate()},beforeDestroy:function(){null!==this.timeoutInstance_IntervalFetch&&clearTimeout(this.timeoutInstance_IntervalFetch)}}),u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["content",{onerror:t.$store.state.errorMsgStr}]},[n("myHeader",[n("div",{staticClass:"statheadermenu",attrs:{slot:"headerMenu"},slot:"headerMenu"},[n("div",{staticClass:"lastupdate"},[n("span",[t._v(t._s(t.lastupdateStr))]),n("br"),t._v("(60秒毎に自動更新)")]),t._v(" "),n("div",{staticClass:"btn-update",on:{click:t.manualUpdate}},[t._v("更新")])])]),t._v(" "),n("div",{staticClass:"timesettings"},[n("select",{staticClass:"date",on:{change:t.changeDay}},[t.$route.query.day?n("option",{attrs:{selected:""},domProps:{value:t.$route.query.day}},[t._v(t._s(t.moment(t.$route.query.day).format("YYYY-MM-DD (ddd)")))]):t._e(),t._v(" "),t._l(t.dayMomentArray,function(e){return n("option",{key:e.unix(),domProps:{value:e.format("YYYYMMDD")}},[t._v(t._s(e.format("YYYY-MM-DD (ddd)")))])})],2),t._v(" "),t.isToday?n("div",{staticClass:"time"},[n("clock"),t._v(" "),n("div",{staticClass:"option"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.bool_hidepasthours,expression:"bool_hidepasthours"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.bool_hidepasthours)?t._i(t.bool_hidepasthours,null)>-1:t.bool_hidepasthours},on:{change:function(e){var n=t.bool_hidepasthours,r=e.target,a=!!r.checked;if(Array.isArray(n)){var i=t._i(n,null);r.checked?i<0&&(t.bool_hidepasthours=n.concat([null])):i>-1&&(t.bool_hidepasthours=n.slice(0,i).concat(n.slice(i+1)))}else t.bool_hidepasthours=a}}}),t._v(" 過ぎた時間帯を隠す")])])],1):t._e()]),t._v(" "),t.$store.state.errorMsgStr?n("errorOneline",{attrs:{errorMsgStr:"データ取得エラーが発生しています "+t.$store.state.errorMsgStr}}):t._e(),t._v(" "),n("transition",{attrs:{name:"fadeup",appear:""}},[t.hourArray[0]&&!t.$store.state.loadingMsg?n("main",{key:t.selectedDay+"hours"},t._l(t.hourArray,function(e){return n("div",{key:""+t.selectedDay+e,class:["hour",{"hour-active":t.isToday&&t.$store.state.moment.format("HH")===e,"hour-hidden":t.isToday&&t.bool_hidepasthours&&t.$store.state.moment.isAfter(t.moment(t.selectedDay+" "+parseInt(e,10)+":59:59","YYYYMMDD H:mm:ss"))}]},[n("div",{staticClass:"items"},t._l(t.performancesByHour[e],function(e){return n("div",{key:""+e.day+e.start_time,class:["item",t.isToday?t.getStatusClassNameByPerformance(t.$store.state.moment,e,10):"item-capable"]},[n("p",{staticClass:"time"},[t._v(t._s(e.start_time)+"～ ("+t._s(e.tour_number)+")")]),t._v(" "),n("div",{staticClass:"wrapper-status"},[n("p",{staticClass:"status-inner"},[n("span",{staticClass:"status status-normal"},[t._v(t._s(e.seat_status))]),t._v(" "),n("span",{staticClass:"status status-wheelchair"},[t._v(t._s(e.wheelchair_available))])]),t._v(" "),n("p",{staticClass:"exstatus"},[n("span",{staticClass:"exstatus-sales_textstatus"},[t._v(t._s(e.sales_textstatus))])])])])}),0)])}),0):t._e()])],1)},staticRenderFns:[]};var l=n("VU/8")(c,u,!1,function(t){n("2GI+")},"data-v-27e504fb",null);e.default=l.exports},aa0c:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW").a.extend({}),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("header",[e("div",{staticClass:"inner"},[this._m(0),this._v(" "),e("nav",[this._t("headerMenu")],2)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",[e("img",{attrs:{src:n("gZZK")}})])}]};var i=n("VU/8")(r,a,!1,function(t){n("5tzQ")},null,null);e.default=i.exports},gZZK:function(t,e,n){t.exports=n.p+"static/img/logo.png"},hILp:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW").a.extend({}),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"loading"}},[e("div",{staticClass:"loading-mask"},[e("div",{staticClass:"loading-wrapper"},[e("div",{staticClass:"loading-container"},[e("div",{staticClass:"loading-header"},[e("h3",[this._v(this._s(this.$store.state.loadingMsg))])]),this._v(" "),e("div",{staticClass:"loading-body"},[e("div",{staticClass:"v-spinner"},[e("div",{staticClass:"v-ring v-ring1"},[e("div",{staticClass:"v-ring v-ring2"}),this._v(" "),e("div",{staticClass:"v-ring v-ring3"})])])])])])])])},staticRenderFns:[]};var i=n("VU/8")(r,a,!1,function(t){n("xZ9N")},"data-v-67e2f5a0",null);e.default=i.exports},wQMa:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("7+uW").a.extend({props:{errorMsgStr:{type:String,required:!0}}}),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"error-oneline"},[e("div",[e("p",[this._v(this._s(this.errorMsgStr))])])])},staticRenderFns:[]};var i=n("VU/8")(r,a,!1,function(t){n("3iqB")},null,null);e.default=i.exports},xZ9N:function(t,e){},yPrU:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("myHeader"),this._v(" "),e("div",{staticClass:"menu"},[e("ul",[e("li",[this._v("[現場スタッフ用]\n                "),e("ul",[e("li",[e("router-link",{attrs:{to:"/rsrvstat"}},[e("span",[this._v("予約状況確認画面")])])],1),this._v(" "),e("li",[e("router-link",{attrs:{to:"/vstrstat"}},[e("span",[this._v("来塔状況確認画面")])])],1)])])])])],1)},staticRenderFns:[]};var a=n("VU/8")({},r,!1,function(t){n("XZz1")},"data-v-47fd9b2b",null);e.default=a.exports}},["H4kj"]);